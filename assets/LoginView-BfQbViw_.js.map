{"version":3,"file":"LoginView-BfQbViw_.js","sources":["../../src/views/LoginView.vue"],"sourcesContent":["<template>\n    <div class=\"flex items-center justify-center min-h-screen\">\n        <form @submit.prevent=\"handleLogin\" class=\"w-full max-w-md bg-white rounded-lg shadow-lg p-8 space-y-6\">\n            <h1 class=\"text-2xl font-bold text-gray-800 text-center\">Login</h1>\n\n            <div class=\"space-y-2\">\n                <label for=\"email\" class=\"block text-sm font-bold text-gray-900 text-left\"\n                    >Email\n                    <input\n                        type=\"text\"\n                        id=\"email\"\n                        v-model=\"email\"\n                        placeholder=\"Enter your email\"\n                        class=\"w-full px-4 py-2 border-2 border-black rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none text-gray-700\"\n                        required\n                    />\n                </label>\n            </div>\n\n            <div class=\"space-y-2\">\n                <label for=\"password\" class=\"block text-sm font-bold text-gray-900\"\n                    >Password\n                    <input\n                        type=\"password\"\n                        id=\"password\"\n                        v-model=\"password\"\n                        placeholder=\"Enter your password\"\n                        class=\"w-full px-4 py-2 border-2 border-black rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none text-gray-700\"\n                        required\n                    />\n                </label>\n            </div>\n\n            <div class=\"flex items-center space-x-2\">\n                <label for=\"isAdmin\" class=\"text-sm font-medium text-gray-900\"\n                    >Log in as Admin\n                    <input\n                        type=\"checkbox\"\n                        id=\"isAdmin\"\n                        v-model=\"isAdmin\"\n                        class=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\n                    />\n                </label>\n            </div>\n\n            <div v-if=\"isAdmin\" class=\"space-y-2\">\n                <label for=\"apiKey\" class=\"block text-sm font-bold text-gray-900\"\n                    >API Key\n                    <input\n                        type=\"text\"\n                        id=\"apiKey\"\n                        v-model=\"apiKey\"\n                        placeholder=\"Enter your API key\"\n                        class=\"w-full px-4 py-2 border-2 border-black rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none text-gray-700\"\n                        required\n                    />\n                </label>\n            </div>\n\n            <button\n                type=\"submit\"\n                class=\"w-full bg-primary text-black py-2 rounded-lg font-bold hover:bg-blue-400 transition duration-300\"\n            >\n                Login\n            </button>\n\n            <button\n                type=\"button\"\n                @click=\"goToRegister\"\n                class=\"w-full bg-gray-600 text-white py-2 rounded-lg font-medium hover:bg-gray-700 transition duration-300\"\n            >\n                Register\n            </button>\n\n            <ErrorMessage :message=\"errorMessage\" />\n        </form>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue';\nimport { useRouter } from 'vue-router';\nimport ErrorMessage from '@/components/Login/ErrorMessage.vue';\nimport { checkEmail, checkPassword, loginAdmin, loginUser } from '@/apis/authenticationApi';\nimport { AxiosError, HttpStatusCode } from 'axios';\nimport { USER_JWT_TOKEN_HEADER } from '@/headers/userHeaders';\nimport { useUserStore } from '@/stores/userStore';\n\nconst userStore = useUserStore();\n\nconst email = ref('');\nconst password = ref('');\nconst errorMessage = ref('');\nconst isAdmin = ref(false);\nconst apiKey = ref('');\nconst router = useRouter();\n\nconst goToRegister = () => {\n    router.push('/register');\n};\n\nconst handleLogin = async (e: Event) => {\n    e.preventDefault();\n\n    if (!checkEmail(email.value)) {\n        errorMessage.value = 'Wrong Email format';\n        return;\n    }\n\n    if (!checkPassword(password.value)) {\n        errorMessage.value = 'Wrong Password format';\n        return;\n    }\n\n    const loginFn = isAdmin.value ? loginAdmin : loginUser;\n\n    try {\n        const response = await loginFn(email.value, password.value, isAdmin.value ? apiKey.value : '');\n        console.log(response);\n        if (response.status === HttpStatusCode.Ok) {\n            userStore.setToken(response.data[USER_JWT_TOKEN_HEADER]);\n            router.push('/');\n        }\n    } catch (error) {\n        handleLoginError(error);\n    }\n};\n\nconst handleLoginError = (error: unknown) => {\n    if (error instanceof AxiosError && error.response) {\n        if (error.response.status === HttpStatusCode.Unauthorized) {\n            errorMessage.value = 'Wrong Api Key';\n        } else {\n            errorMessage.value = 'Invalid username or password.';\n        }\n    } else {\n        errorMessage.value = 'An unknown error occurred.';\n    }\n};\n</script>\n"],"names":["userStore","useUserStore","email","ref","password","errorMessage","isAdmin","apiKey","router","useRouter","goToRegister","handleLogin","e","checkEmail","checkPassword","loginFn","loginAdmin","loginUser","response","HttpStatusCode","USER_JWT_TOKEN_HEADER","error","handleLoginError","AxiosError","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_cache","_hoisted_2","_hoisted_3","$event","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_createVNode","ErrorMessage"],"mappings":"wuBAwFA,MAAMA,EAAYC,EAAa,EAEzBC,EAAQC,EAAI,EAAE,EACdC,EAAWD,EAAI,EAAE,EACjBE,EAAeF,EAAI,EAAE,EACrBG,EAAUH,EAAI,EAAK,EACnBI,EAASJ,EAAI,EAAE,EACfK,EAASC,EAAU,EAEnBC,EAAe,IAAM,CACvBF,EAAO,KAAK,WAAW,CAC3B,EAEMG,EAAc,MAAOC,GAAa,CAGpC,GAFAA,EAAE,eAAe,EAEb,CAACC,EAAWX,EAAM,KAAK,EAAG,CAC1BG,EAAa,MAAQ,qBACrB,MAAA,CAGJ,GAAI,CAACS,EAAcV,EAAS,KAAK,EAAG,CAChCC,EAAa,MAAQ,wBACrB,MAAA,CAGE,MAAAU,EAAUT,EAAQ,MAAQU,EAAaC,EAEzC,GAAA,CACM,MAAAC,EAAW,MAAMH,EAAQb,EAAM,MAAOE,EAAS,MAAOE,EAAQ,MAAQC,EAAO,MAAQ,EAAE,EAC7F,QAAQ,IAAIW,CAAQ,EAChBA,EAAS,SAAWC,EAAe,KACnCnB,EAAU,SAASkB,EAAS,KAAKE,CAAqB,CAAC,EACvDZ,EAAO,KAAK,GAAG,SAEda,EAAO,CACZC,EAAiBD,CAAK,CAAA,CAE9B,EAEMC,EAAoBD,GAAmB,CACrCA,aAAiBE,GAAcF,EAAM,SACjCA,EAAM,SAAS,SAAWF,EAAe,aACzCd,EAAa,MAAQ,gBAErBA,EAAa,MAAQ,gCAGzBA,EAAa,MAAQ,4BAE7B,gBAzIImB,EAAA,EAAAC,EA2EM,MA3ENC,EA2EM,CA1EFC,EAyEO,OAAA,CAzEA,WAAgBhB,EAAW,CAAA,SAAA,CAAA,EAAE,MAAM,6DAAA,GACtCiB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAD,EAAmE,KAA/D,CAAA,MAAM,gDAA+C,QAAK,EAAA,GAE9DA,EAYM,MAZNE,EAYM,CAXFF,EAUQ,QAVRG,EAUQ,eATH,QACD,KAAAH,EAOE,QAAA,CANE,KAAK,OACL,GAAG,6CACMzB,EAAK,MAAA6B,GACd,YAAY,mBACZ,MAAM,gIACN,SAAA,EAAA,gBAHS7B,EAAK,KAAA,QAQ1ByB,EAYM,MAZNK,EAYM,CAXFL,EAUQ,QAVRM,EAUQ,eATH,WACD,KAAAN,EAOE,QAAA,CANE,KAAK,WACL,GAAG,gDACMvB,EAAQ,MAAA2B,GACjB,YAAY,sBACZ,MAAM,gIACN,SAAA,EAAA,gBAHS3B,EAAQ,KAAA,QAQ7BuB,EAUM,MAVNO,EAUM,CATFP,EAQQ,QARRQ,EAQQ,eAPH,kBACD,KAAAR,EAKE,QAAA,CAJE,KAAK,WACL,GAAG,+CACMrB,EAAO,MAAAyB,GAChB,MAAM,mEAAA,gBADGzB,EAAO,KAAA,QAMjBA,EAAO,OAAlBkB,EAAA,EAAAC,EAYM,MAZNW,EAYM,CAXFT,EAUQ,QAVRU,EAUQ,eATH,UACD,KAAAV,EAOE,QAAA,CANE,KAAK,OACL,GAAG,8CACMpB,EAAM,MAAAwB,GACf,YAAY,qBACZ,MAAM,gIACN,SAAA,EAAA,gBAHSxB,EAAM,KAAA,8BAQ3BoB,EAKS,SAAA,CAJL,KAAK,SACL,MAAM,kGAAA,EACT,UAED,EAAA,GAEAA,EAMS,SAAA,CALL,KAAK,SACJ,QAAOjB,EACR,MAAM,uGACT,YAED,EAEA4B,EAAwCC,EAAA,CAAzB,QAASlC,EAAY,KAAA,EAAA,KAAA,EAAA,CAAA,SAAA,CAAA,CAAA"}